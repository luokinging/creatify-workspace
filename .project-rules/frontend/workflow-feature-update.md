---
description: Feature Update 工作流程 - 现有功能增强或扩展的标准流程
---

# 工作流程：Feature Update（功能增强）

**原则：先设计后实现，保持向后兼容，逐步迭代。**

---

## 步骤 1：需求分析与设计

1. **需求拆解**
   - 将大需求拆分为小任务
   - 识别核心功能和次要功能
   - 确定优先级

2. **代码分析**
   - 分析现有功能实现
   - 理解现有架构和模块职责
   - 查找可复用的代码和组件
   - **重要：** 如果识别到可复用的组件/函数等，优先抽取出复用部分，单独作为一个组件或工具函数

3. **架构设计**
   - 是否需要新增 Manager？
   - 是否需要调整现有模块的职责？
   - 数据流是怎样的？
   - 需要新增哪些类型定义？

4. **评估风险**
   - 是否会影响现有功能？
   - 是否需要修改现有接口？
   - 是否需要数据迁移？

**输出物：**
- 列出需要修改的文件列表
- 列出需要新增的文件列表
- 描述数据流和模块职责

---

## 步骤 2：分阶段实施

**推荐顺序：**

### 阶段 1：基础设施 (Infrastructure)
- 创建必要的目录结构
- 定义接口（Interface）和类型（Type）
- 创建 Manager 骨架（只有 `bootstrap` 和 `dispose`）
- 运行类型检查确保基础结构正确

### 阶段 2：数据层 (Data Layer)
- 实现 API 调用函数（在 `api/` 目录）
- 实现 Manager 的数据获取逻辑
- 实现状态管理
- 运行类型检查确保数据层正确

### 阶段 3：视图层 (View Layer)
- 实现基础 UI 组件（在 `component/` 目录）
- 实现 Block 组件（在 `block/` 目录）
- **重要：** 如果识别到可复用的组件/函数等，优先抽取出复用部分，单独作为一个组件
- 组装 Page 组件
- 运行类型检查和 lint 检查

### 阶段 4：交互与优化 (Interaction & Optimization)
- 实现用户交互逻辑
- 添加 Loading/Error 状态处理
- 优化代码结构和性能
- 最终验证所有检查通过

---

## 步骤 3：增量验证

**每个阶段完成后：**
1. 运行类型检查
2. 运行代码格式检查
3. 运行代码质量检查
4. 读取并修复所有错误

---

## 步骤 4：最终验证

- [ ] 所有类型检查通过
- [ ] 所有 lint 检查通过
- [ ] 代码遵循项目架构规范
- [ ] 所有 Manager 都实现了 `bootstrap` 和 `dispose`
- [ ] 没有未使用的导入和代码
- [ ] 代码可读性和可维护性良好

