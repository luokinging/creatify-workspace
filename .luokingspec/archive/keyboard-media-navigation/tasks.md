# T-001 为视频和音频预览添加键盘左右键导航功能

## 需求描述

**Feature：键盘左右键导航**
- 在 `/mushroom/project/preview` 路由下，为视频和音频预览添加键盘左右键导航功能
- 用户可以通过按左键/右键来快速前进/后退播放进度
- 步进值为 5 秒（与常见视频播放器一致）
- 支持全屏和非全屏模式

**需求类型**：Feature

**涉及领域**：前端

**功能要求**：
- 按左键（ArrowLeft）：后退 5 秒
- 按右键（ArrowRight）：前进 5 秒
- 只在视频和音频预览页面生效
- 避免在输入框等可编辑元素中触发
- 支持全屏和非全屏模式

## 相关指引

**前端规则:**
- `.project-rules/frontend/architecture.md` - 了解 Manager 模式和架构设计
- `.project-rules/frontend/index.md` - 了解必须阅读的文档

**前端Code Point:**
- `webserver/frontend/feature/mushroom/hook/preview/use-keyboard-playback-control.ts` - 现有键盘控制 hook（仅支持空格键播放/暂停）
- `webserver/frontend/feature/mushroom/component/preview/video-preview.tsx` - 视频预览组件
- `webserver/frontend/feature/mushroom/component/preview/audio-preview.tsx` - 音频预览组件
- `webserver/frontend/feature/mushroom/hook/preview/use-media-playback.ts` - 媒体播放控制 hook（提供 handleSeek 方法）

**前端路由:**
- `/mushroom/project/preview` - 预览页面路由

## 注意点

- 现有代码已有 `useKeyboardPlaybackControl` hook，目前只支持空格键播放/暂停，需要扩展支持左右键
- 需要正确处理输入框等可编辑元素，避免在这些元素中触发快捷键
- 步进值固定为 5 秒，不需要配置化
- 确保在全屏模式下也能正常工作
- 需要与现有的 `handleSeek` 方法集成，保持代码一致性
- 键盘事件监听需要在组件卸载时正确清理

## Scenario

### Scenario 1: 用户在视频预览页面使用左右键导航

    **场景描述：**
    - **前置条件**：用户在视频预览页面，视频正在播放或暂停
    - **操作步骤**：
      1. 视频播放到第 30 秒
      2. 用户按右键（ArrowRight）
      3. 视频播放进度跳转到第 35 秒
      4. 用户按左键（ArrowLeft）
      5. 视频播放进度跳回到第 30 秒
    - **预期结果**：
      - 每次按右键，播放进度前进 5 秒
      - 每次按左键，播放进度后退 5 秒
      - 视频继续播放或暂停状态保持不变
      - 进度条更新到正确位置

### Scenario 2: 用户在音频预览页面使用左右键导航

    **场景描述：**
    - **前置条件**：用户在音频预览页面，音频正在播放或暂停
    - **操作步骤**：
      1. 音频播放到第 1 分 20 秒
      2. 用户按右键（ArrowRight）两次
      3. 音频播放进度跳转到第 1 分 30 秒
    - **预期结果**：
      - 每次按键前进 5 秒
      - 两次按键共前进 10 秒
      - 音频播放状态和进度条正确更新

### Scenario 3: 用户在输入框中输入时不触发快捷键

    **场景描述：**
    - **前置条件**：用户在预览页面，焦点在输入框中（如评论输入框）
    - **操作步骤**：
      1. 用户点击评论输入框，开始输入文字
      2. 用户按左键或右键移动光标
    - **预期结果**：
      - 左右键不触发媒体导航功能
      - 光标正常移动，用于编辑文字

### Scenario 4: 用户在全屏模式下使用左右键导航

    **场景描述：**
    - **前置条件**：用户在视频预览页面，已进入全屏模式
    - **操作步骤**：
      1. 用户进入全屏模式
      2. 视频播放到第 50 秒
      3. 用户按右键
    - **预期结果**：
      - 视频播放进度跳转到第 55 秒
      - 全屏状态下功能正常工作

### Scenario 5: 空格键播放/暂停功能不受影响

    **场景描述：**
    - **前置条件**：用户在视频预览页面
    - **操作步骤**：
      1. 视频正在播放
      2. 用户按空格键
      3. 视频暂停
      4. 用户按右键
      5. 视频进度前进 5 秒，但仍保持暂停状态
      6. 用户按空格键
      7. 视频继续播放
    - **预期结果**：
      - 空格键播放/暂停功能正常工作
      - 左右键导航不影响播放/暂停状态

## Checklist

- [x] C-001 扩展 `useKeyboardPlaybackControl` hook，支持左右键导航
- [x] C-002 左键后退 5 秒，右键前进 5 秒
- [x] C-003 在输入框等可编辑元素中不触发快捷键
- [x] C-004 功能在视频预览页面正常工作
- [x] C-005 功能在音频预览页面正常工作
- [x] C-006 功能在全屏模式下正常工作
- [x] C-007 空格键播放/暂停功能不受影响
- [x] C-008 组件卸载时正确清理事件监听器
- [x] C-009 进度条正确更新显示
- [x] C-010 代码格式化通过（bun biome:fix）
- [x] C-011 TypeScript 类型检查通过（bun precommit）
